<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Actualités – Janssen Trust</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#0b1220] text-white">
  <div class="bg-black/30 border-b border-white/10 text-center text-sm py-2">WealthElite — NY / Dubai · Janssen Trust</div>
  <header class="border-b border-white/10">
    <div class="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-3 font-semibold">
        <img src="assets/wealth_elite_logo.png" class="h-8" alt="Logo"/>
        <span class="hidden sm:inline opacity-70">NY / Dubai</span>
      </a>
      <nav class="hidden md:flex items-center gap-8 text-sm">
        <a href="informations.html" class="hover:text-brand-400">Informations</a>
        <a href="histoire.html" class="hover:text-brand-400">Histoire</a>
        <a href="actualites.html" class="text-brand-400">Actualités</a>
        <a href="index.html#contact" class="hover:text-brand-400">Contact</a>
      </nav>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <h1 class="text-3xl md:text-4xl font-bold">Actualités</h1>
    <p class="mt-3 text-white/70 max-w-3xl">Briefs marchés, géopolitique & annonces internes.</p>

    <!-- FEED SUPABASE -->
    <section id="feed" class="mt-8 grid md:grid-cols-2 gap-6"></section>
  </main>

  <footer class="border-t border-white/10 py-8 text-xs text-white/60 text-center">© <span id="y"></span> WealthElite — NY / Dubai</footer>
  <script>
    // Année dans le footer
    document.getElementById('y').textContent = new Date().getFullYear();

    // -------- Supabase Feed --------
    const SUPABASE_URL = "https://ywpshnlnbpyfplapzzac.supabase.co";           // <-- remplace
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3cHNobmxuYnB5ZnBsYXB6emFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcyODg1NTYsImV4cCI6MjA3Mjg2NDU1Nn0.J-0ATeb3dxkQ6m4E0KuDLOHD072akgielLKQb-m22B8";                         // <-- remplace
    const CATEGORY = "news";                                           // actualites = news

    async function loadPosts() {
      const url = `${SUPABASE_URL}/rest/v1/posts?select=*&category=eq.${CATEGORY}&order=created_at.desc`;
      const res = await fetch(url, {
        headers: { apikey: SUPABASE_ANON_KEY, Authorization: `Bearer ${SUPABASE_ANON_KEY}` }
      });
      const posts = await res.json();
      renderPosts(posts);
    }

    function esc(s) {
      return (s ?? "").toString().replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    function renderPosts(posts) {
      const root = document.getElementById('feed');
      if (!posts.length) {
        root.innerHTML = `<div class="text-white/60">Aucune publication pour le moment.</div>`;
        return;
      }
      root.innerHTML = posts.map(p => `
        <article class="bg-white/5 border border-white/10 rounded-2xl p-6">
          <h2 class="font-semibold text-lg">${esc(p.title || 'Publication')}</h2>
          ${p.link_url ? `<p class="mt-2 text-sm"><a class="text-blue-300 underline break-all" href="${esc(p.link_url)}" target="_blank" rel="noopener">Lien</a></p>` : ``}
          ${p.media_url ? `<img src="${esc(p.media_url)}" alt="" class="mt-3 rounded-xl w-full h-auto"/>` : ``}
          ${p.content ? `<p class="mt-3 text-white/80 text-sm whitespace-pre-wrap">${esc(p.content)}</p>` : ``}
          ${p.btc_price ? `<p class="mt-3 text-xs text-white/50">BTC lors du post : ${Number(p.btc_price).toFixed(2)} €</p>` : ``}
          <div class="mt-4 flex items-center justify-between text-xs text-white/50">
            <span>${new Date(p.created_at).toLocaleString('fr-BE')}</span>
            <span>${esc(p.author || '—')}</span>
          </div>
        </article>
      `).join('');
    }

    document.addEventListener('DOMContentLoaded', loadPosts);
  </script>
</body>
</html>